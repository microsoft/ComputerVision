pool:
  name: cvbpbuildagents
  vmImage: 'linuxagent-gpu'

steps:

- script: |
      mkdir tools/repo_metrics
      cp tools/repo_metrics/config_template.py tools/repo_metrics/config.py
      sed -i ''s/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/$(github_token)/g'' tools/repo_metrics/config.py
      sed -i ''s/XXXXXXXXXXXXXXXXXXXXXXXXX/$(cosmosdb_connectionstring)/g'' tools/repo_metrics/config.py
  displayName: Configure CosmosDB Connection

- script: | 
      source activate cvbp
      python tools/repo_metrics/track_metrics.py --github_repo "https://github.com/microsoft/ComputerVision" --save_to_database \
      source deactivate
  displayName: Python script to record stats


